# This scene contains enough for RenderTest to pass.

Scene "RealScene" {
  gantry: Gantry {
    cameras: [
      WindowCamera {
        position:    1 2 3,
        orientation: 0 1 0 30,
        fov:         45,
        near:        2,
        far:         10,
      },
    ],
  },
  lights: [
    PointLight {
      position:     1 2 3,
      color:        1 0 1 1,
    },
  ],
  render_passes: [
    ShadowPass "Shadow" {
      shader_programs: [ <"programs/ShadowDepth.emd"> ]
    },
    LightingPass "Lighting" {
      shader_programs: [
        <"programs/FixedLighting.emd">,  # Needed for Lighting program.
        <"programs/Lighting.emd">,
      ],
    },
  ],
  root_node: Node "Root" {
    CONSTANTS: [
      LCT:    "count: 1",
      MAT4_0: "0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0",
    ],
    shader_names: ["ShadowDepth", "Lighting"],
    state_table: StateTable {
      clear_color:        0.4 0.4 0.4 1,
      clear_depth:        0.5,
      line_width:         0.6,
      depth_test_enabled: True,
      cull_face_enabled:  True,
      cull_face_mode:     "kCullFront",
    },
    blocks: [
      UniformBlock "ShadowBlock" {
        pass_name: "Shadow",
        uniforms: [
          Uniform "uCastShadows" { int_val:  1       },
          Uniform "uLightMatrix" { mat4_val: $MAT4_0 },
          Uniform "uModelMatrix" { mat4_val: $MAT4_0 },
        ],
      },
      UniformBlock "LightingBlock" {
        pass_name: "Lighting",
        textures: [
          Texture "Default Texture" {
            uniform_name: "uTexture",
            image:   FileImage { path: "White.jpg" },
            sampler: Sampler "DefaultSampler" {},
          },
          Texture "ShadowMap Texture" {
            $LCT,  # One per light.
            uniform_name: "uLightShadowMap",
            sampler: Sampler "ShadowMapSampler" {
              auto_mipmaps: True,
              min_filter:   "kLinearMipmapLinear",
              mag_filter:   "kLinear",
            },
          },
        ],
        uniforms: [
          Uniform "uAmbientIntens"    { float_val:       .3        },
          Uniform "uBaseColor"        { vec4f_val:       "#b3b3b3" }
          Uniform "uEmissiveColor"    { vec4f_val:       "#000000" },
          Uniform "uLightColor"       { $LCT, vec4f_val: "#000000" },
          Uniform "uLightCount"       { int_val:         0         },
          Uniform "uLightMatrix"      { $LCT, mat4_val:  $MAT4_0   },
          Uniform "uLightPos"         { $LCT, vec3f_val: 0 0 0     },
          Uniform "uMetalness"        { float_val:       0         },
          Uniform "uProjectionMatrix" { mat4_val:        $MAT4_0   },
          Uniform "uReceiveShadows"   { int_val:         1         },
          Uniform "uShowTexture"      { int_val:         0         },
          Uniform "uSmoothness"       { float_val:       0         },
          Uniform "uTextureOffset"    { vec2f_val:       0 0       },
          Uniform "uTextureScale"     { vec2f_val:       1 1       },
          Uniform "uTwoSidedLighting" { int_val:         0         },
          Uniform "uViewMatrix"       { mat4_val:        $MAT4_0   },
          Uniform "uViewPos"          { vec3f_val:       0 0 0     },
          Uniform "uViewportSize"     { vec2i_val:       0 0       },
        ],
      },
    ],
    children: [
      # For testing text rendering.
      TextNode {
        text: "Hi!",
      },
      # For testing RenderPass management.
      Node "PassTestNode" {
        shader_names: ["ShadowDepth"],
      },
      # For testing shape disabling.
      Node "DisabledNode" {
        disabled_flags: "kRender",
        shapes: [ Box { size: 3 4 5 } ],
      },
    ],
  },
}
